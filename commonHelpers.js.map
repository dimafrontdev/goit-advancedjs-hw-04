{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '45156920-6e611072a4f9c22ae400d324b';\nconst BASE_URL = 'https://pixabay.com/api';\n\nexport const fetchImages = async (query, page = 1, perPage = 15) => {\n  const params = {\n    key: API_KEY,\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: 'true',\n    page: page,\n    per_page: perPage,\n  };\n\n  try {\n    const response = await axios.get('/', { params });\n    return response.data;\n  } catch (error) {\n    throw error;\n  }\n};\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst gallery = document.querySelector('.gallery');\n\nconst loadImage = (src) => {\n  return new Promise((resolve, reject) => {\n    const img = new Image();\n    img.src = src;\n    img.onload = () => resolve(src);\n    img.onerror = (error) => reject(error);\n  });\n};\n\nexport const renderImages = async (images, reset = false) => {\n  if (reset) {\n    gallery.innerHTML = ''; \n  }\n\n  const imagePromises = images.map(image => loadImage(image.webformatURL));\n  await Promise.all(imagePromises);\n\n  gallery.innerHTML += images\n    .map(\n      image => `\n    <a href=\"${image.largeImageURL}\" class=\"gallery-item\">\n      <img src=\"${image.webformatURL}\" alt=\"${image.tags}\">\n      <div class=\"info\">\n        <div>\n          <p>Likes</p>\n          <p>${image.likes}</p>\n        </div>\n        <div>\n          <p>Views</p>\n          <p>${image.views}</p>\n        </div>\n        <div>\n          <p>Comments</p>\n          <p>${image.comments}</p>\n        </div>\n        <div>\n          <p>Downloads</p>\n          <p>${image.downloads}</p>\n        </div>\n      </div>\n    </a>\n  `\n    )\n    .join('');\n\n  const lightbox = new SimpleLightbox('.gallery a', {\n    captions: true,\n    captionsData: 'alt',\n    captionPosition: 'bottom',\n  });\n  lightbox.refresh();\n};\n\nexport const notificationsConfig = {\n    position: 'topRight',\n    messageColor: 'white',\n    iconColor: 'white',\n}\n\nexport const showErrorNotification = message => {\n  iziToast.error({\n    message: message,\n    color: '#EF4040',\n    ...notificationsConfig\n  });\n};\n\nexport const showNotification = message => {\n    iziToast.info({\n      message: message,\n      color: '#0099FF',\n      ...notificationsConfig\n    });\n  };\n\n","import { fetchImages } from './js/pixabay-api';\nimport { renderImages, showNotification } from './js/render-functions';\n\nconst form = document.querySelector('.search-form');\nconst input = document.querySelector('.search-form input[name=\"search\"]');\nconst gallery = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst loadMoreBtn = document.querySelector('.load-more');\n\nlet currentPage = 1;\nlet currentQuery = '';\nlet totalImagesLoaded = 0; \n\nconst handleSubmitForm = async (event) => {\n  event.preventDefault();\n  const query = input.value.trim();\n\n  if (!query) {\n    showNotification('Please enter a search query.');\n    return;\n  }\n\n  loadMoreBtn.style.display = 'none';\n  loader.style.display = 'none';\n  currentPage = 1;\n  totalImagesLoaded = 0; \n  currentQuery = query;\n\n  try {\n    loader.style.display = 'flex';\n    const data = await fetchImages(query, currentPage);\n    totalImagesLoaded = data.hits.length;\n\n    if (data.hits.length === 0) {\n      showNotification('Sorry, there are no images matching your search query. Please try again!');\n      return;\n    }\n\n    await renderImages(data.hits, true); \n\n    if (totalImagesLoaded < data.totalHits) {\n      loadMoreBtn.style.display = 'block'; \n    } else {\n      showNotification(\"We're sorry, but you've reached the end of search results.\");\n    }\n  } catch (error) {\n    showNotification('An error occurred while fetching images. Please try again later.');\n  } finally {\n    loader.style.display = 'none'; \n    form.reset();\n  }\n};\n\nconst handleLoadMore = async () => {\n  currentPage += 1;\n  \n  loadMoreBtn.style.display = 'none';\n  loader.style.display = 'flex';\n\n  try {\n    const data = await fetchImages(currentQuery, currentPage);\n    totalImagesLoaded += data.hits.length;\n\n    await renderImages(data.hits);\n\n    const { height: cardHeight } = document.querySelector('.gallery-item').getBoundingClientRect();\n    window.scrollBy({\n      top: cardHeight * 2 + 48,\n      behavior: 'smooth',\n    });\n\n    if (totalImagesLoaded >= data.totalHits) {\n      showNotification(\"We're sorry, but you've reached the end of search results.\");\n    } else {\n      loadMoreBtn.style.display = 'block'; \n    }\n  } catch (error) {\n    showNotification('An error occurred while fetching more images. Please try again later.');\n  } finally {\n    loader.style.display = 'none';\n  }\n};\n\nform.addEventListener('submit', handleSubmitForm);\nloadMoreBtn.addEventListener('click', handleLoadMore);\n"],"names":["API_KEY","fetchImages","query","page","perPage","params","axios","error","gallery","loadImage","src","resolve","reject","img","renderImages","images","reset","imagePromises","image","SimpleLightbox","notificationsConfig","showNotification","message","iziToast","form","input","loader","loadMoreBtn","currentPage","currentQuery","totalImagesLoaded","handleSubmitForm","event","data","handleLoadMore","cardHeight"],"mappings":"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"}